scalar Date

type Location {
  countryCode: String
  townCity: String!
  openLocationCode: String
}

type ContactInfo {
  name: String!
  email: String
  phone: String
  signal: String
  whatsApp: String
}

input LocationInput {
  countryCode: String
  townCity: String!
  openLocationCode: String
}

input ContactInfoInput {
  name: String!
  email: String
  phone: String
  signal: String
  whatsApp: String
}

type Group {
  id: Int!
  name: String!
  groupType: GroupType!
  primaryLocation: Location!
  primaryContact: ContactInfo!
  website: String

  createdAt: Date!
  updatedAt: Date!
}

input GroupInput {
  name: String!
  groupType: GroupType!
  primaryLocation: LocationInput!
  primaryContact: ContactInfoInput!
  website: String
}

input ShipmentUpdateInput {
  shippingRoute: ShippingRoute
  labelYear: Int
  labelMonth: Int
  sendingHubId: Int
  receivingHubId: Int
  status: ShipmentStatus
}

type Query {
  listGroups: [Group!]!
  listShipments: [Shipment!]!
  group(id: Int!): Group!
  shipment(id: Int!): Shipment!
}

type Mutation {
  addGroup(input: GroupInput!): Group!
  addShipment(input: ShipmentInput!): Shipment!
  addOffer(input: OfferCreateInput!): Offer!
  updateOffer(input: OfferUpdateInput!): Offer!
  updateShipment(id: Int!, input: ShipmentUpdateInput!): Shipment!
}

input ShipmentInput {
  shippingRoute: ShippingRoute!
  labelYear: Int!
  labelMonth: Int!
  sendingHubId: Int!
  receivingHubId: Int!
  status: ShipmentStatus!
}

enum ShippingRoute {
  UK
}

enum ShipmentStatus {
  ANNOUNCED
  OPEN
  STAGING
  IN_PROGRESS
  COMPLETE
  ABANDONED
}

type Shipment {
  id: Int!
  shippingRoute: ShippingRoute!
  # label{year,month} are for identification purposes only e.g. for deriving
  # display names like "UK-2021-03".
  labelYear: Int!
  labelMonth: Int!
  offerSubmissionDeadline: Date
  status: ShipmentStatus!
  sendingHubId: Int!
  sendingHub: Group!
  receivingHubId: Int!
  receivingHub: Group!

  # default to created
  statusChangeTime: Date!
  createdAt: Date!
  updatedAt: Date!
}

enum GroupType {
  DA_HUB
  RECEIVING_GROUP
  SENDING_GROUP
}

type UserProfile {
  id: Int!
  isAdmin: Boolean!
}

enum OfferStatus {
  DRAFT
  PROPOSED
  BEING_REVIEWED
  REJECTED
  ACCEPTED
}

type Offer {
  id: Int!
  status: OfferStatus!
  shipmentId: Int!
  sendingGroupId: Int!

  # if null contact is group default
  contact: ContactInfo

  photoUris: [String!]!

  statusChangeTime: Date!
  updatedAt: Date!
  createdAt: Date!
}

input OfferCreateInput {
  sendingGroupId: Int!
  shipmentId: Int!
  contact: ContactInfoInput
  photoUris: [String!]
}

input OfferUpdateInput {
  id: Int!
  status: OfferStatus
  contact: ContactInfoInput
  photoUris: [String!]
}
